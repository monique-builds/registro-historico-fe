<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"                 
                xmlns="http://www.w3.org/1999/xhtml"                 
                xmlns:c="http://java.sun.com/jsp/jstl/core"                 
                xmlns:f="http://java.sun.com/jsf/core"                 
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:o="http://omnifaces.org/ui"
                xmlns:p="http://primefaces.org/ui">   

    <h:form id="form">
        <f:passThroughAttribute name="autocomplete" value="off" />

        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item">
                    <a href="#{ConstantesPaginas.IR_A_INICIO}.xhtml">#{msg.gestionCertificaciones}</a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">#{msg.solicitudCertificacion}</li>
            </ol>
        </nav>

        <p:outputPanel styleClass="panel-titulo-pagina">
            <h2 class="page-header">
                <h:outputText value="#{msg.solicitudCertificacion}" />
            </h2>

            <div class="lineaHeader">
                <div class="verde"></div><div class="amarillo"></div><div class="rojo"></div><div class="celeste"></div>
            </div>
        </p:outputPanel>

        <fieldset>
            <p:outputPanel id="formularioDatosGenerales">
                <fieldset>
                    <legend>
                        <h:outputText value="#{msg.datosGenerales}" />
                    </legend>
                    <p:outputPanel styleClass="col-md-10">
                        <p:outputPanel styleClass="form-group row" id="fila_input_centroEducativo">
                            <h:outputLabel value="#{msg.centroEducativo}" styleClass="col-sm-3 col-form-label obligatorio"
                                           for="b_centroEducativo"  />
                            <p:outputPanel styleClass="col-sm-8">
                                <h:inputText autocomplete="off" id="b_centroEducativo" styleClass="form-control"
                                             value="#{certificacionBean.entidadEnEdicion.certificacionNivel}" readonly="#{!certificacionBean.editar}" />
                            </p:outputPanel>
                        </p:outputPanel>

                        <p:outputPanel styleClass="form-group row" id="fila_input_departamento">
                            <h:outputLabel value="#{msg.departamento}" styleClass="col-sm-3 col-form-label obligatorio"
                                           for="b_departamento" />
                            <p:outputPanel styleClass="col-sm-8">
                                <h:inputText autocomplete="off" id="b_departamento" styleClass="form-control"
                                             value="#{certificacionBean.entidadEnEdicion.certiDepartamento}" readonly="#{!certificacionBean.editar}"/>
                            </p:outputPanel>
                        </p:outputPanel>

                        <p:outputPanel styleClass="form-group row" id="fila_input_municipio">
                            <h:outputLabel value="#{msg.municipio}" styleClass="col-sm-3 col-form-label obligatorio"
                                           for="b_municipio" />
                            <p:outputPanel styleClass="col-sm-8">
                                <h:inputText autocomplete="off" id="b_municipio" styleClass="form-control"
                                             value="#{certificacionBean.entidadEnEdicion.certiMunicipio}" readonly="#{!certificacionBean.editar}" />
                            </p:outputPanel>
                        </p:outputPanel>

                        <p:outputPanel styleClass="form-group row" id="fila_input_nombre_estudiante">
                            <h:outputLabel value="#{msg.hestudiante}" for="input_nombre_estudiante"
                                           styleClass="col-sm-3 col-form-label obligatorio" />
                            <p:outputPanel styleClass="col-sm-8">
                                <h:inputText autocomplete="off" id="input_nombre_estudiante" styleClass="form-control"
                                             value="#{certificacionBean.entidadEnEdicion.estudiante}" readonly="#{!certificacionBean.editar}" />
                            </p:outputPanel>
                        </p:outputPanel>

                        <p:outputPanel styleClass="form-group row">
                            <h:outputLabel value="#{msg.nie}" for="input_nie"
                                           styleClass="col-sm-3 col-form-label obligatorio" />
                            <p:outputPanel styleClass="col-sm-8">
                                <h:inputText autocomplete="off" id="input_nie" styleClass="form-control"
                                             value="#{certificacionBean.entidadEnEdicion.nie}" readonly="#{!certificacionBean.editar}"/>
                            </p:outputPanel>
                        </p:outputPanel>

                        <p:outputPanel styleClass="form-group row" id="fila_input_anio">
                            <h:outputLabel value="#{msg.anio}" styleClass="col-sm-3 col-form-label obligatorio"
                                           for="input_anio" />
                            <p:outputPanel styleClass="col-sm-8">
                                <p:inputMask id="input_anio" styleClass="form-control texto-extra-corto"
                                             value="#{certificacionBean.entidadEnEdicion.anio}" mask="9999" readonly="#{!certificacionBean.editar}"/>
                            </p:outputPanel>
                        </p:outputPanel>

                        <p:outputPanel styleClass="form-group row" id="fila_input_nivel">
                            <h:outputLabel value="#{msg.niveles}" styleClass="col-sm-3 col-form-label obligatorio"
                                           for="b_nivel" />
                            <p:outputPanel styleClass="col-sm-8">
                                <h:inputText autocomplete="off" id="b_nivel" styleClass="form-control"
                                             value="#{certificacionBean.entidadEnEdicion.certificacionNivel}" readonly="#{!certificacionBean.editar}" />
                            </p:outputPanel>
                        </p:outputPanel>

                        <p:outputPanel styleClass="form-group row" id="fila_input_observacion">
                            <h:outputLabel value="#{msg.observacion}" for="input_observacion"
                                           styleClass="col-sm-3 col-form-label" />
                            <p:outputPanel styleClass="col-sm-8">
                                <p:inputTextarea id="input_observacion" styleClass="form-control"
                                                 value="#{certificacionBean.entidadEnEdicion.certiObservaciones}" counter="display"
                                                 maxlength="4000" counterTemplate="{0} caracteres restantes." autoResize="false"  readonly="#{!certificacionBean.editar}"/>
                                <h:outputText styleClass="form-control-plaintext"
                                              value="#{certificacionBean.entidadEnEdicion.certiObservaciones}" />
                                <h:outputText id="display" />
                            </p:outputPanel>
                        </p:outputPanel>
                    </p:outputPanel>
                </fieldset>

                <fieldset>
                    <legend>
                        <h:outputText value="#{msg.agregarMaterias}" />
                    </legend>

                    <!-- Formulario para agregar materias -->
                    <p:outputPanel styleClass="form-group row">
                        <h:outputLabel value="Materia" styleClass="col-sm-2 col-form-label" />
                        <p:outputPanel styleClass="col-sm-4">
                            <p:inputText value="#{certificacionBean.nuevaMateria.materia}" styleClass="form-control" />
                        </p:outputPanel>

                        <h:outputLabel value="Área" styleClass="col-sm-2 col-form-label" />
                        <p:outputPanel styleClass="col-sm-4">
                            <p:inputText value="#{certificacionBean.nuevaMateria.area}" styleClass="form-control" />
                        </p:outputPanel>
                    </p:outputPanel>

                    <p:outputPanel styleClass="form-group row">
                        <h:outputLabel value="Nota" styleClass="col-sm-2 col-form-label" />
                        <p:outputPanel styleClass="col-sm-4">
                            <p:inputText value="#{certificacionBean.nuevaMateria.nota}" styleClass="form-control" />
                        </p:outputPanel>

                        <h:outputLabel value="Resultado" styleClass="col-sm-2 col-form-label" />
                        <p:outputPanel styleClass="col-sm-4">
                            <p:inputText value="#{certificacionBean.nuevaMateria.resultado}" styleClass="form-control" />
                        </p:outputPanel>
                    </p:outputPanel>

                    <p:outputPanel styleClass="form-group row">
                        <p:outputPanel styleClass="col-sm-2"></p:outputPanel>
                        <p:outputPanel styleClass="col-sm-10 text-right">
                            <p:commandButton value="Agregar Materia" styleClass="btn btn-primary"
                                             action="#{certificacionBean.agregarMateria()}" update="idTablaMaterias" />
                        </p:outputPanel>
                    </p:outputPanel>

                    <!-- Tabla para mostrar las materias agregadas -->
                    <p:dataTable value="#{certificacionBean.materias}" var="materia" id="idTablaMaterias"
                                 emptyMessage="#{msg.noHayResultados}">
                        <p:column headerText="Materia">
                            #{materia.materia}
                        </p:column>
                        <p:column headerText="Área">
                            #{materia.area}
                        </p:column>
                        <p:column headerText="Nota">
                            #{materia.nota}
                        </p:column>
                        <p:column headerText="Resultado">
                            #{materia.resultado}
                        </p:column>
                        <p:column>
                            <p:commandButton  action="#{certificacionBean.eliminarMateria(materia)}"  icon="glyphicon glyphicon-trash" 
                                              styleClass="btn btn-icono rojo" title="#{msg.eliminar}" 
                                              update="idTablaMaterias" />
                        </p:column>
                    </p:dataTable>
                </fieldset>

                <!-- Botón de Guardar dentro del fieldset principal -->
                <p:outputPanel styleClass="col-md-12 texto-right">
                    <p:commandButton id="btnGuardarAsociacion" value="#{msg.guardar}" action="#{certificacionBean.guardar()}"
                                     update="formularioDatosGenerales" styleClass="btn btn-primary" icon="glyphicon glyphicon-floppy-disk">
                        <p:blockUI block="formularioDatosGenerales" trigger="btnGuardarAsociacion" />
                    </p:commandButton>
                </p:outputPanel>
            </p:outputPanel>
        </fieldset>

        <h:panelGroup styleClass="volverLink" layout="block">
            <p:commandLink value="#{msg.volver}" onclick="history.go(-1)" styleClass="btn btn-link" />
        </h:panelGroup>
    </h:form>
</ui:composition>